<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Code Editor</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Basic Reset & Body Styling */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Fira Code', monospace, sans-serif; /* A monospaced font for code */
            background-color: #282c34; /* Dark background */
            color: #abb2bf; /* Light text color */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        header {
            background-color: #21252b;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #3e4451;
        }

        header h1 {
            color: #61afef;
            margin-bottom: 10px;
        }

        header p {
            font-size: 0.9em;
            color: #56b6c2;
        }

        main {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Editor Container */
        .editor-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap; /* Allows wrapping on smaller screens */
        }

        .code-panels {
            flex: 2; /* Takes more space */
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 300px; /* Minimum width for code panels */
        }

        .code-panel {
            background-color: #1e2127;
            border: 1px solid #3e4451;
            border-radius: 8px;
            padding: 15px;
            flex: 1; /* Each code panel takes equal height */
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Hide scrollbar for textarea initially */
        }

        .code-panel h2 {
            color: #e06c75;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        textarea {
            width: 100%;
            height: 100%; /* Occupy full height of parent */
            resize: none; /* Disable manual resizing */
            background-color: #1e2127;
            border: none;
            color: #abb2bf;
            font-family: 'Fira Code', monospace;
            font-size: 1em;
            padding: 10px;
            outline: none;
            line-height: 1.5;
            overflow-y: auto; /* Enable vertical scroll if content overflows */
            white-space: pre; /* Preserve whitespace and line breaks */
            word-wrap: normal;
        }

        /* Custom scrollbar for textareas */
        textarea::-webkit-scrollbar {
            width: 8px;
        }

        textarea::-webkit-scrollbar-track {
            background: #282c34;
            border-radius: 10px;
        }

        textarea::-webkit-scrollbar-thumb {
            background: #4b5263;
            border-radius: 10px;
        }

        textarea::-webkit-scrollbar-thumb:hover {
            background: #5c6370;
        }


        .preview-container {
            flex: 1; /* Takes less space than code panels */
            background-color: #ffffff; /* White background for preview */
            border: 1px solid #3e4451;
            border-radius: 8px;
            padding: 15px;
            min-height: 400px; /* Minimum height for preview */
            display: flex;
            flex-direction: column;
            min-width: 300px;
        }

        .preview-container h2 {
            color: #c678dd;
            margin-bottom: 10px;
            font-size: 1.1em;
            color: #282c34; /* Darker color for heading in light background */
        }

        #output-preview {
            width: 100%;
            height: 100%;
            border: none;
            background-color: #ffffff;
        }

        /* AI Interaction Section */
        .ai-interaction-container {
            background-color: #1e2127;
            border: 1px solid #3e4451;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-interaction-container h2 {
            color: #98c379;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .ai-input-area {
            display: flex;
            gap: 10px;
            align-items: flex-end; /* Align button to bottom of textarea */
        }

        #ai-prompt-input {
            flex-grow: 1;
            min-height: 60px;
            border-radius: 5px;
            padding: 10px;
            background-color: #282c34;
            border: 1px solid #3e4451;
            color: #abb2bf;
            font-family: 'Fira Code', monospace;
            font-size: 0.95em;
            resize: vertical; /* Allow vertical resizing for prompt input */
        }

        #ask-gemini-btn {
            background-color: #61afef;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.2s ease;
            height: fit-content; /* Adjust height to content */
        }

        #ask-gemini-btn:hover {
            background-color: #529cdd;
        }

        .ai-response-area {
            margin-top: 10px;
            padding: 15px;
            background-color: #282c34;
            border: 1px solid #3e4451;
            border-radius: 5px;
        }

        .ai-response-area h3 {
            color: #56b6c2;
            font-size: 1em;
            margin-bottom: 8px;
        }

        #gemini-response {
            white-space: pre-wrap; /* Preserve whitespace and wrap long lines */
            word-break: break-word; /* Break words if too long */
            font-family: 'Fira Code', monospace;
            font-size: 0.9em;
            color: #abb2bf;
            max-height: 300px; /* Limit height for response area */
            overflow-y: auto; /* Add scroll if content overflows */
            padding-right: 5px; /* Space for scrollbar */
        }

        /* Custom scrollbar for response area */
        #gemini-response::-webkit-scrollbar {
            width: 8px;
        }

        #gemini-response::-webkit-scrollbar-track {
            background: #282c34;
            border-radius: 10px;
        }

        #gemini-response::-webkit-scrollbar-thumb {
            background: #4b5263;
            border-radius: 10px;
        }

        #gemini-response::-webkit-scrollbar-thumb:hover {
            background: #5c6370;
        }


        footer {
            background-color: #21252b;
            padding: 15px;
            text-align: center;
            font-size: 0.8em;
            color: #5c6370;
            margin-top: auto; /* Pushes footer to the bottom */
            border-top: 1px solid #3e4451;
        }

        /* Responsive adjustments */
        @media (min-width: 768px) {
            .editor-container {
                flex-direction: row; /* Side-by-side on larger screens */
            }

            .code-panels {
                flex-direction: row; /* Side-by-side HTML, CSS, JS */
            }

            .code-panel {
                flex: 1; /* Each takes equal width */
            }
        }

        @media (max-width: 767px) {
            .editor-container {
                flex-direction: column; /* Stacked on small screens */
            }

            .code-panels {
                flex-direction: column; /* Stacked HTML, CSS, JS */
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>AI-Powered Code Editor</h1>
        <p>Write your code and get assistance from Gemini AI.</p>
    </header>

    <main>
        <div class="editor-container">
            <div class="code-panels">
                <div class="code-panel html-panel">
                    <h2>HTML</h2>
                    <textarea id="html-code" spellcheck="false" placeholder="Write your HTML here..."></textarea>
                </div>
                <div class="code-panel css-panel">
                    <h2>CSS</h2>
                    <textarea id="css-code" spellcheck="false" placeholder="Write your CSS here..."></textarea>
                </div>
                <div class="code-panel js-panel">
                    <h2>JavaScript</h2>
                    <textarea id="js-code" spellcheck="false" placeholder="Write your JavaScript here..."></textarea>
                </div>
            </div>
            <div class="preview-container">
                <h2>Output Preview</h2>
                <iframe id="output-preview"></iframe>
            </div>
        </div>

        <div class="ai-interaction-container">
            <h2>Gemini AI Assistant</h2>
            <div class="ai-input-area">
                <textarea id="ai-prompt-input" placeholder="Ask Gemini to generate code, explain concepts, or refactor... e.g., 'Generate a responsive navigation bar using flexbox'." rows="3"></textarea>
                <button id="ask-gemini-btn">Ask Gemini</button>
            </div>
            <div class="ai-response-area">
                <h3>Gemini's Response:</h3>
                <pre id="gemini-response">Waiting for your prompt...</pre>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 AI-Powered Code Editor. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const htmlCode = document.getElementById('html-code');
            const cssCode = document.getElementById('css-code');
            const jsCode = document.getElementById('js-code');
            const outputPreview = document.getElementById('output-preview');

            const aiPromptInput = document.getElementById('ai-prompt-input');
            const askGeminiBtn = document.getElementById('ask-gemini-btn');
            const geminiResponse = document.getElementById('gemini-response');

            // Function to update the output preview
            function updatePreview() {
                const html = htmlCode.value;
                const css = `<style>${cssCode.value}</style>`;
                const js = `<script>${jsCode.value}<\/script>`; // Escape </script> for security

                const combinedCode = `
                    <!DOCTYPE html>
                    <html lang="en">
                    <head>
                        <meta charset="UTF-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1.0">
                        <title>Preview</title>
                        ${css}
                    </head>
                    <body>
                        ${html}
                        ${js}
                    </body>
                    </html>
                `;

                // Write the combined code into the iframe's document
                outputPreview.contentWindow.document.open();
                outputPreview.contentWindow.document.write(combinedCode);
                outputPreview.contentWindow.document.close();
            }

            // Event listeners for code changes
            htmlCode.addEventListener('input', updatePreview);
            cssCode.addEventListener('input', updatePreview);
            jsCode.addEventListener('input', updatePreview);

            // Initial preview update
            updatePreview();


            // --- AI Integration Placeholder ---
            askGeminiBtn.addEventListener('click', async () => {
                const prompt = aiPromptInput.value.trim();

                if (!prompt) {
                    geminiResponse.textContent = "Please enter a prompt for Gemini.";
                    return;
                }

                geminiResponse.textContent = "Asking Gemini... Please wait.";
                askGeminiBtn.disabled = true; // Disable button while processing

                try {
                    // !!! IMPORTANT: This is where you would call your *backend server*
                    // Your backend server would then securely call Google's Gemini API
                    // For demonstration, we'll simulate a delay and a dummy response.

                    // Example of a server-side fetch (this won't work without a backend)
                    // const response = await fetch('/api/gemini-chat', {
                    //     method: 'POST',
                    //     headers: {
                    //         'Content-Type': 'application/json'
                    //     },
                    //     body: JSON.stringify({ prompt: prompt })
                    // });
                    // const data = await response.json();
                    // if (response.ok) {
                    //     geminiResponse.textContent = data.response;
                    // } else {
                    //     geminiResponse.textContent = `Error from AI: ${data.error || 'Unknown error'}`;
                    // }

                    // --- SIMULATED AI RESPONSE (REMOVE IN PRODUCTION) ---
                    await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate API call delay
                    let simulatedResponse = "";
                    if (prompt.toLowerCase().includes("navigation bar")) {
                        simulatedResponse = `
\`\`\`html
<nav class="navbar">
    <div class="container">
        <a href="#" class="logo">MyBrand</a>
        <ul class="nav-links">
            <li><a href="#">Home</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Services</a></li>
            <li><a href="#">Contact</a></li>
        </ul>
    </div>
</nav>
\`\`\`

\`\`\`css
.navbar {
    background-color: #333;
    padding: 1rem 0;
}

.navbar .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

.navbar .logo {
    color: white;
    font-size: 1.5rem;
    font-weight: bold;
    text-decoration: none;
}

.navbar .nav-links {
    list-style: none;
    display: flex;
}

.navbar .nav-links li {
    margin-left: 20px;
}

.navbar .nav-links a {
    color: white;
    text-decoration: none;
    transition: color 0.3s ease;
}

.navbar .nav-links a:hover {
    color: #61afef;
}
\`\`\`

This is a basic responsive navigation bar using flexbox. For full responsiveness, you might add a hamburger menu for smaller screens.
                        `;
                    } else if (prompt.toLowerCase().includes("explain css flexbox")) {
                        simulatedResponse = `
Flexbox (Flexible Box Module) is a one-dimensional layout method for arranging items in rows or columns. It's designed for distributing space among items in an interface and aligning them.

**Key Concepts:**
- **Flex Container:** The parent element on which \`display: flex;\` is applied.
- **Flex Items:** The direct children of the flex container.
- **Main Axis:** The primary axis along which flex items are laid out (horizontal by default for \`flex-direction: row;\`, vertical for \`flex-direction: column;\`).
- **Cross Axis:** The axis perpendicular to the main axis.

**Common Flex Container Properties:**
- \`flex-direction\`: Defines the direction of the main axis (\`row\`, \`row-reverse\`, \`column\`, \`column-reverse\`).
- \`justify-content\`: Aligns items along the main axis (\`flex-start\`, \`flex-end\`, \`center\`, \`space-between\`, \`space-around\`, \`space-evenly\`).
- \`align-items\`: Aligns items along the cross axis (\`flex-start\`, \`flex-end\`, \`center\`, \`baseline\`, \`stretch\`).
- \`flex-wrap\`: Controls whether items wrap to the next line (\`nowrap\`, \`wrap\`, \`wrap-reverse\`).
- \`gap\`: Sets the gap between flex items.

**Common Flex Item Properties:**
- \`flex-grow\`: Defines the ability of a flex item to grow if necessary.
- \`flex-shrink\`: Defines the ability of a flex item to shrink if necessary.
- \`flex-basis\`: Defines the default size of an element before the remaining space is distributed.
- \`flex\`: A shorthand for \`flex-grow\`, \`flex-shrink\`, and \`flex-basis\`.
- \`align-self\`: Overrides the container's \`align-items\` for a specific item.
                        `;
                    } else {
                        simulatedResponse = `Hello! I'm Gemini AI. I can help you with code generation, explanations, and more. Try asking me to "Generate a responsive navigation bar" or "Explain CSS Flexbox".`;
                    }
                    geminiResponse.textContent = simulatedResponse;
                    // --- END SIMULATED AI RESPONSE ---

                } catch (error) {
                    console.error('Error fetching AI response:', error);
                    geminiResponse.textContent = `Sorry, I couldn't get a response from Gemini. Error: ${error.message}`;
                } finally {
                    askGeminiBtn.disabled = false; // Re-enable button
                }
            });
        });
    </script>
</body>
</html>
